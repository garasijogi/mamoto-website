var summernoteForm=$("#aboutForm"),summernoteElement=$("#post"),summernoteSaveButton=$("#saveAbout"),summernoteResetButton=$("#resetAbout"),summernote_defaultText="Mamoto Pictures.",about_url=$('input[name="about_url"]').val(),token_csrf=$('input[name="token_csrf"]').val(),btn_deleteImage=$(".btn-image-delete"),btn_showGallery=$("#showGallery"),btn_showImage=$(".btn-image-view"),gallery_content=$(".gallery-content"),modal_gallery=$("#modalGallery"),modal_galleryBody=$(".modal-body-gallery"),modal_galleryContainer=$(".gallery-container"),modal_galleryContent=$(".gallery-content"),modal_galleryPaginate=1,icon_save=$(".saveIcon"),allowedTypes="pdf,doc,docx,ppt,pptx,xps,odt,xls,xlsx,wps,jpg,jpeg,gif,png",index="/_gallery.json",path="gallery/about",upload_url=$('input[name="upload_url"]').val(),url_getIndex=$('input[name="url_getIndex"]').val(),url_removeIndex=$('input[name="url_removeIndex"]').val(),url_path=$('input[name="url_path"]').val();const Toast=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}});function updateAbout(){$.ajax({headers:{"X-CSRF-TOKEN":token_csrf},url:about_url,data:{post:summernoteElement.summernote("code")},method:"POST",beforeSend:function(){Swal.fire({icon:"info",title:"Menyimpan Perubahan...",html:'<p>Harap Tunggu, sistem sedang menyimpan perubahanmu.<br/><br/><i class="fa fa-spinner fa-spin fa-2x"></i></p>',showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1})},success:function(e){icon_save.empty().append('<i class="fa fa-save"></i>'),summernoteSaveButton.removeClass("btn-primary").addClass("btn-secondary"),Toast.fire({icon:"success",title:"Perubahanmu sudah disimpan"})}})}function toastValidateError(){Toast.fire({icon:"error",title:"Harap isi about post"})}summernoteElement.summernote({height:300,focus:!0,height:500,placeholder:"Hi, Please type the post, you can add photos or videos too.",tabDisable:!0,tabsize:4,lang:"id-ID",toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough","superscript","subscript"]],["fontsize",["undo","redo","fontsize"]],["color",["color"]],["para",["ul","ol","paragraph","style"]],["height",["height"]],["insert",["gallery","video","link","hr"]],["view",["fullscreen","codeview","help"]]],callbacks:{onChange:function(e,a){summernoteElement.val(summernoteElement.summernote("isEmpty")?"":e),icon_save.empty().append('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>'),summernoteElement.summernote("isEmpty")?(summernoteElement.parent().addClass("bg-danger"),toastValidateError()):summernoteElement.parent().removeClass("bg-danger"),summernoteSaveButton.removeClass("btn-secondary").addClass("btn-primary")},onInit:function(){$(".summernote-spinner").hide()}},gallery:{source:{url:url_getIndex+"?page=1&path="+path+"&index="+index+"&url_getIndex="+url_getIndex+"&url_getNextPage=1&url_path="+url_path+"&path="+path,nextPageKey:"links.next"},modal:{loadOnScroll:!0,title:"Tambahkan Gambar",close_text:"Batalkan",ok_text:"Tambahkan",selectAll_text:"Pilih Semua",deselectAll_text:"Pilih Tidak Semua",noImageSelected_msg:"Tidak ada gambar yang dipilih, harap pilih satu"}}}),summernoteResetButton.on("click",function(){Swal.fire({title:"Reset postingan about?",text:"Kamu akan menghapus semua postingan about!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya",cancelButtonText:"Tidak",focusCancel:!0,allowOutsideClick:!1}).then(e=>{e.isConfirmed&&(summernoteElement.summernote("code",summernote_defaultText),updateAbout())})}),summernoteSaveButton.on("click",function(){summernoteElement.summernote("isEmpty")?(summernoteElement.parent().addClass("bg-danger"),toastValidateError()):(summernoteElement.parent().removeClass("bg-danger"),updateAbout())});var url_gallery=url_getIndex+"?page="+modal_galleryPaginate+"&path="+path+"&index="+index+"&url_getIndex="+url_getIndex+"&url_getNextPage=1&url_path="+url_path+"&path="+path,url_gallery_next="";function getPhotos(e){null!=e&&""!=e&&null!=e&&$.ajax({headers:{"X-CSRF-TOKEN":token_csrf},type:"GET",url:e,dataType:"JSON",success:function(e){url_gallery_next=e.links.next,$.each(e.data,function(e,a){id=a.name.split(".")[0],gallery_content.append('<div class="col-lg-2 col-md-6 col-sm-6 col-6 p-2"><div class="d-flex justify-content-center"><div class="card p-2"><div style="overflow:hidden"><div class="rr-gallery-container-image"><div class="rr-gallery-box rr-gallery-stack-image"><img class="rr-gallery-image" src="'+a.src+'" alt="'+a.title+'" /></div><div class="rr-gallery-box rr-gallery-stack-top"><div class="rr-gallery-box-button-container"><div class="btn-group"><a href="javascript:showImage(\''+a.src+"', '"+a.title+'\')" class="btn btn-info btn-image-view"><i class="fa fa-search"></i></a><a href="javascript:deleteImage(\''+a.name+'\')" class="btn btn-danger btn-image-delete" id="'+id+'"><i class="fa fa-trash"></i></a></div></div></div></div></div></div></div></div>')}),null!=url_gallery_next&&""!=url_gallery_next&&null!=url_gallery_next||$(".gallery-spinner").hide()}})}function deleteImage(e){Swal.fire({title:"Hapus Foto Ini?",html:"<p>Anda akan menghapus foto ini dari website.</p>",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#0072c6",confirmButtonText:"Ya",cancelButtonText:"Tidak"}).then(a=>{a.isConfirmed&&$.ajax({headers:{"X-CSRF-TOKEN":token_csrf},type:"POST",data:{id:e,path:path,index:index},url:url_removeIndex,beforeSend:function(){Swal.fire({icon:"info",title:"Menghapus Foto...",html:'<p>Harap Tunggu, sistem sedang menghapus foto.<br/><br/><i class="fa fa-spinner fa-spin fa-2x"></i></p>',showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1})},success:function(a){1==a?(Swal.fire("Dihapus!","Foto telah dihapus.","success"),el="#"+e.split(".")[0],$(el).parents(".col-lg-2").remove()):Swal.fire("Oops...","Something went wrong!","error")},error:function(e){Swal.fire("Server Error","Please contact Website Admin!","error")}})})}function afterUpload(e){modal_galleryContent.empty(),getPhotos(url_gallery),Toast.fire({icon:"success",title:"The File was successfully uploaded"})}function afterError(e,a,t,n){Toast.fire({icon:"error",title:"Oops, Something went wrong!"})}btn_showGallery.on("click",function(){modal_gallery.modal("show"),getPhotos(url_gallery)}),modal_gallery.on("hidden.bs.modal",function(e){modal_galleryContent.empty(),$(".gallery-spinner").show()}),modal_galleryBody.on("scroll",function(){var e=Math.floor(modal_galleryContainer.height());Math.floor(modal_galleryBody.height()+modal_galleryBody.scrollTop())>=e&&getPhotos(url_gallery_next)}),$("#fileuploader").uploadFile({headers:{"X-CSRF-TOKEN":token_csrf},url:upload_url,allowedTypes:allowedTypes,dragdropWidth:"100%",fileName:"myfile",dynamicFormData:function(){return{path:path,index:index}},multiple:!0,showStatusAfterSuccess:!1,showProgress:!0,sequentialCount:1,onLoad:function(e){},onSubmit:function(e){},onSuccess:function(e,a,t,n){},afterUploadAll:function(e){afterUpload(e)},onError:function(e,a,t,n){afterError(e,a,t,n)}});var imageViewer_modal=$(".imageViewer-modal"),img=document.getElementById("myImg"),modalImg=$("#imageViewer-img"),captionText=document.getElementById("imageViewer-caption"),imageViewer_closeBtn=document.getElementsByClassName("imageViewer-close")[0];function showImage(e,a){modalImg.attr("src",e),captionText.innerHTML=a,imageViewer_modal.css("display","block")}imageViewer_closeBtn.onclick=function(){imageViewer_modal.css("display","none")};
